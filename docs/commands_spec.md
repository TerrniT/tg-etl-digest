# Commands Spec

## `/start`
- Отправляет приветствие и краткую инструкцию по `/add` и `/analytic`.

## `/add`
Вход:
- Аргументы в команде или отдельное сообщение (FSM state).

Поведение:
- Парсит `@handle`, `handle`, `t.me/handle`, `https://t.me/handle`.
- Удаляет дубли (идемпотентно).
- Применяет лимиты:
  - max каналов за вызов;
  - max каналов пользователя.

Выход:
- Разделы: добавлено, уже было, невалидно, отклонено по лимиту, обрезано по лимиту вызова.

## `/list`
- Показывает все каналы пользователя (персонально по `from_user.id`).

## `/remove`
- Удаляет связь пользователя с каналом.
- Возвращает «удалено» или «не найдено в списке пользователя».

## `/analytic`
Поведение:
1. Загружает каналы пользователя.
2. Если каналов больше лимита вызова — обрабатывает первые `N` и добавляет предупреждение.
3. Для каждого канала:
   - extract последних 5 текстовых постов;
   - transform;
   - summarize;
   - fallback на ошибки.
4. Собирает блоки и режет на Telegram-чанки.
5. Отправляет chunks последовательно.

Формат блока:
- Первая строка: `https://t.me/<handle>`
- Далее summary
- Далее (опционально) список ссылок на посты
